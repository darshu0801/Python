import pandas as pd

# Load the Excel file
input_file = 'input.xlsx'  # Replace with your input file path
output_file = 'output.xlsx'  # Replace with your desired output file path

# Read the input Excel file
df = pd.read_excel(input_file)

# Assuming columns are named "Time" and "Event", replace with actual names if different
time_col = 'Time'  # Column containing time
event_col = 'Event'  # Column containing events

# Filter rows with "Quad Plane Page Write Operation"
filtered_df = df[df[event_col] == "Quad Plane Page Write Operation"]

# Calculate time differences between consecutive rows (no datetime conversion)
filtered_df['Time Difference'] = filtered_df[time_col].diff()

# Save the result to a new Excel file
filtered_df.to_excel(output_file, index=False)

print(f"Time differences saved to {output_file}")