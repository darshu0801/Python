import pandas as pd

# Load the CSV file
file_path = "your_file.csv"  # Replace with your CSV file path
data = pd.read_csv(file_path)

# Extract relevant columns
time_col = data.iloc[:, 1]  # Assuming the 2nd column is the time
event_col = data.iloc[:, 2]  # Assuming the 3rd column has the events

# Filter only "Quad Plane Page Write Operation" rows
write_events = data[event_col == "Quad Plane Page Write Operation"]

# Convert time column to datetime
write_events['Time'] = pd.to_datetime(write_events[time_col])

# Calculate time differences between consecutive write operations
write_events['Time_Diff'] = write_events['Time'].diff().dt.total_seconds()

# Create the new DataFrame
result_df = write_events[['Time_Diff']].dropna().reset_index(drop=True)
result_df.index += 1  # Start index from 1
result_df.reset_index(inplace=True)
result_df.columns = ['Index', 'Time_Diff']

# Save to Excel
output_file = "time_differences.xlsx"  # Specify your output file name
result_df.to_excel(output_file, index=False)

print(f"Time differences saved to {output_file}")