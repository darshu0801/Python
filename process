import os

def extract_mean_unit_interval(file_path):
    """
    Extracts the value next to 'Mean Unit Interval (ps)' in the specified .html file as a string,
    excluding any associated units.
    """
    with open(file_path, 'r') as file:
        content = file.read()

    # Search for the string 'Mean Unit Interval (ps)' in the content
    search_str = "Mean Unit Interval (ps)"
    start_idx = content.find(search_str)

    if start_idx != -1:
        # Extract the portion of the content after the search string
        start_idx += len(search_str)
        
        # Skip any spaces or colons that may follow the search string
        while start_idx < len(content) and content[start_idx] in " :":
            start_idx += 1
        
        # Extract the value (until we encounter a space or non-numeric character)
        end_idx = start_idx
        while end_idx < len(content) and (content[end_idx].isalnum() or content[end_idx] == '.'):
            end_idx += 1

        value = content[start_idx:end_idx].strip()
        return value
    
    return None

def find_and_process_files(folder_path):
    """
    Finds all files containing P0, P1, ..., P10 in their names, extracts Mean Unit Interval values.
    """
    values = []
    for i in range(11):  # From P0 to P10
        identifier = f"P{i}"
        
        # Search for files containing the identifier
        for file_name in os.listdir(folder_path):
            if identifier in file_name and file_name.endswith('.html'):
                file_path = os.path.join(folder_path, file_name)
                print(f"Processing {file_name}...")
                value = extract_mean_unit_interval(file_path)
                if value is not None:
                    values.append(value)
                else:
                    print(f"No 'Mean Unit Interval (ps)' found in {file_name}.")
                break  # Process only one matching file per identifier
        else:
            print(f"No file found for identifier {identifier}.")
    
    return values

# Usage
folder_path = "your_folder_path"  # Replace with the path to your folder containing .html files
mean_unit_intervals = find_and_process_files(folder_path)
print("Extracted Mean Unit Interval values:", mean_unit_intervals)