#!/bin/bash

# Log file for data
LOG_FILE="/tmp/ssd_usage.log"
DEVICE="nvme0n1"  # Change this to match your SSD device

# Clear previous data
echo "" > $LOG_FILE

# Start iostat monitoring
echo "Monitoring SSD performance... Press Ctrl+C to stop."

# Run iostat every second and log results
( while true; do
    iostat -dx 1 1 | awk -v dev="$DEVICE" '$1 == dev {print strftime("%H:%M:%S"), $6, $7}' >> $LOG_FILE
    sleep 1
done ) &

# Start gnuplot for live plotting
gnuplot -persist <<-EOF
    set title "Live SSD Performance"
    set xlabel "Time"
    set ylabel "Speed (MB/s)"
    set yrange [0:*]
    set key outside
    set grid
    set datafile separator " "
    set xdata time
    set timefmt "%H:%M:%S"
    set format x "%H:%M:%S"
    plot "< tail -n 60 $LOG_FILE" using 1:2 with lines title "Read MB/s", \
         "< tail -n 60 $LOG_FILE" using 1:3 with lines title "Write MB/s"
    pause 1
    reread
EOF












Warning: empty x range [59794:59794], adjusting to [59196.1:60391.9]
QStandardPaths: XDG_RUNTIME_DIR not set, defaulting to '/tmp/runtime-root'
